import{d as S,a as j,u as U,r as c,c as v,w as u,f as k,o as V,e as s,G as M,h as e,i as b,$ as g,Q as T,R as B,T as h,Y as F,a0 as R,M as $,N as A,I as E,j as D,s as G,C as I,A as O}from"./index-9bc846b3.js";import{_ as P}from"./BackButton.vue_vue_type_script_setup_true_lang-718faedf.js";import{E as Q}from"./EntryService-ae4ff408.js";import{u as Y,a as p}from"./vee-validate.esm-2cc436d4.js";const q=O("div",{class:"text-h5 text-center font-weight-bold"},"Создать",-1),X=S({__name:"CreatingPage",setup(z){let n=j().getUser(),w=U(),y=[{name:"Запись",type:"mentor"},{name:"Урок",type:"lesson"},{name:"Клуб",type:"club"}],r=c(),o=c(!1),i=c(!1);const{meta:x,handleSubmit:_,handleReset:H,validate:C}=Y({validationSchema:{subject(a){return!a||a.length<4?"слишком короткий заголовок":a.length>25?"слишком длинный заголовок":!0},description(a){return!a||a.length<20?"слишком короткое описание":a.length>150?"слишком длинное описание":!0},limit(a){return o.value?!a||a.length===0?"заполните поле или уберите лимит":!/^\d+$/.test(a)||!(Number(a)>0)?"неверное значение":Number(a)>300?"многовато":!0:!0}}});let m=p("subject"),d=p("description"),f=p("limit");const N=_(async a=>{i.value=!0,await Q.create(Object.assign(a,{type:r.value,school:n.school._id,town:n.town._id})).then(()=>w.push(`/user/${n._id}`)).finally(()=>i.value=!1)});return(a,t)=>(V(),v(k,null,{default:u(()=>[s(P),s(I,{cols:"12",sm:"8",lg:"5",class:"ma-auto"},{default:u(()=>[q,s(M,{label:"Что?",items:e(y),modelValue:e(r),"onUpdate:modelValue":t[0]||(t[0]=l=>b(r)?r.value=l:r=l),"item-title":"name","item-value":"type",variant:"solo",class:"mt-4"},null,8,["items","modelValue"]),s(g,{name:"bounce"},{default:u(()=>[e(r)?(V(),v(T,{key:0,onSubmit:B(e(N),["prevent"]),class:"d-flex flex-column align-center justify-center w-100"},{default:u(()=>[s(h,{label:"Заголовок",placeholder:e(r)=="Клуб"?"Клуб любителей Мафии":"Биология",modelValue:e(m).value.value,"onUpdate:modelValue":t[1]||(t[1]=l=>e(m).value.value=l),"error-messages":e(m).errorMessage.value,variant:"solo",class:"w-100"},null,8,["placeholder","modelValue","error-messages"]),s(F,{label:"Описание",modelValue:e(d).value.value,"onUpdate:modelValue":t[2]||(t[2]=l=>e(d).value.value=l),"error-messages":e(d).errorMessage.value,counter:150,variant:"solo",class:"w-100"},null,8,["modelValue","error-messages"]),s(R,{label:"Лимит учеников",modelValue:e(o),"onUpdate:modelValue":t[3]||(t[3]=l=>b(o)?o.value=l:o=l),onClick:t[4]||(t[4]=l=>e(C)()),class:"w-100","hide-details":""},null,8,["modelValue"]),s(g,{name:"bounce"},{default:u(()=>[$(s(h,{type:"number",variant:"solo",label:"Сколько?",modelValue:e(f).value.value,"onUpdate:modelValue":t[5]||(t[5]=l=>e(f).value.value=l),"error-messages":e(f).errorMessage.value,class:"w-100 mb-3"},null,8,["modelValue","error-messages"]),[[A,e(o)]])]),_:1}),s(E,{color:"accent",disabled:!e(x).valid,type:"submit",loading:e(i)},{default:u(()=>[D("Отправить")]),_:1},8,["disabled","loading"])]),_:1},8,["onSubmit"])):G("",!0)]),_:1})]),_:1})]),_:1}))}});export{X as default};
