import{_ as j}from"./MainTitle.vue_vue_type_script_setup_true_lang-c61e4cd8.js";import{_ as A}from"./MentorEntry.vue_vue_type_script_setup_true_lang-9bcd444a.js";import{d as B,a as T,E as h,r as w,c as f,w as o,f as M,o as c,e as u,j as x,C as p,G as V,h as r,i as S,B as U,n as N,p as F,S as R,F as y,s as G}from"./index-0dd273a2.js";import{T as L}from"./TownService-fb6f9671.js";import{S as P}from"./SchoolService-f1053fa0.js";import{E as C}from"./EntryService-15ba0c51.js";import"./BackButton.vue_vue_type_script_setup_true_lang-79b91714.js";const Q=B({__name:"MentorsSearchPage",async setup(q){let t,d;document.title="Поиск наставников — Ищу наставника";let i=T();function v(e){for(var n,l,_=e.length-1;_>0;_--)n=Math.floor(Math.random()*(_+1)),l=e[n],e[n]=e[_],e[_]=l;return e}let g=([t,d]=h(()=>L.getTowns()),t=await t,d(),t).data,b=([t,d]=h(()=>P.get_all()),t=await t,d(),t).data,s=w(i.getAuthStatus()?i.getUser().town:g.find(e=>e._id==="641c882f9a4751bf88848223")),a=w(i.getAuthStatus()?i.getUser().school:{name:"Все",_id:"all"}),m=w(([t,d]=h(()=>C.get("mentor",s.value._id,a.value._id)),t=await t,d(),t).data.filter(e=>!e.responses.includes(i.getUser()._id)&&e.author._id!==i.getUser()._id&&(e.school._id==a.value._id||e.town._id===s.value._id&&a.value._id==="all")));v(m.value);async function k(){m.value=(await C.get("mentor",s.value._id,a.value._id)).data.filter(e=>!e.responses.includes(i.getUser()._id)&&e.author._id!==i.getUser()._id&&(e.school._id==a.value._id||e.town._id===s.value._id&&a.value._id==="all")),v(m.value)}function E(){return b.filter(e=>e.town._id===s.value._id)}return(e,n)=>(c(),f(M,null,{default:o(()=>[u(j,null,{default:o(()=>[x("Поиск наставников")]),_:1}),u(U,{class:"ma-0 pa-0 mt-4",style:{gap:"12px"}},{default:o(()=>[u(p,{cols:"12",md:"4",sm:"8",xs:"12",class:"ml-0 pa-0"},{default:o(()=>[u(V,{label:"Город",modelValue:r(s),"onUpdate:modelValue":n[0]||(n[0]=l=>S(s)?s.value=l:s=l),items:r(g),"item-title":"name","return-object":"",variant:"solo","hide-details":""},null,8,["modelValue","items"])]),_:1}),u(p,{cols:"12",md:"4",sm:"8",xs:"12",class:"ma-0 pa-0"},{default:o(()=>[u(V,{label:"Школа",modelValue:r(a),"onUpdate:modelValue":[n[1]||(n[1]=l=>S(a)?a.value=l:a=l),k],items:[{name:"Все",_id:"all"},...E()],"item-title":"name","return-object":"",variant:"solo","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),u(U,{class:"w-100 mt-8 flex-row flex-wrap"},{default:o(()=>[(c(!0),N(y,null,F(r(m),l=>(c(),f(p,{cols:"12",sm:"6",key:l._id},{default:o(()=>[(c(),f(R,null,{default:o(()=>[u(A,{entry:l,show_location:r(a)._id==="all"},null,8,["entry","show_location"])]),_:2},1024))]),_:2},1024))),128))]),_:1}),r(m).length===0?(c(),f(p,{key:0,cols:"12",sm:"6",xs:"12",class:"text-h6 ma-auto font-weight-medium mt-4 text-center"},{default:o(()=>[x("Записей нет, или вы на всё откликнулись")]),_:1})):G("",!0)]),_:1}))}});export{Q as default};
