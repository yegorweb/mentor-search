import{_ as A}from"./MainTitle.vue_vue_type_script_setup_true_lang-276e8807.js";import{_ as E}from"./MentorEntry.vue_vue_type_script_setup_true_lang-f594a3a2.js";import{d as T,a as B,w as h,r as w,c as f,b as o,g as N,o as c,f as d,k as x,D as p,G as V,j as r,i as S,C as b,p as F,q as M,S as R,F as q,v as y}from"./index-7dc65faa.js";import{T as D}from"./TownService-78832f7f.js";import{S as G}from"./SchoolService-ed707a02.js";import{E as C}from"./EntryService-e0219c97.js";import"./BackButton.vue_vue_type_script_setup_true_lang-a6a8d385.js";const Q=T({__name:"ClubsSearchPage",async setup(L){let t,n;document.title="Поиск клубов — Ищу наставника";let i=B();function v(e){for(var u,l,_=e.length-1;_>0;_--)u=Math.floor(Math.random()*(_+1)),l=e[u],e[u]=e[_],e[_]=l;return e}let g=([t,n]=h(()=>D.getTowns()),t=await t,n(),t).data,U=([t,n]=h(()=>G.get_all()),t=await t,n(),t).data,s=w(i.getAuthStatus()?i.getUser().town:g.find(e=>e._id==="641c882f9a4751bf88848223")),a=w(i.getAuthStatus()?i.getUser().school:{name:"Все",_id:"all"}),m=w(([t,n]=h(()=>C.get("club",s.value._id,a.value._id)),t=await t,n(),t).data.filter(e=>!e.responses.includes(i.getUser()._id)&&e.author._id!==i.getUser()._id&&(e.school._id==a.value._id||e.town._id===s.value._id&&a.value._id==="all")));v(m.value);async function k(){m.value=(await C.get("club",s.value._id,a.value._id)).data.filter(e=>!e.responses.includes(i.getUser()._id)&&e.author._id!==i.getUser()._id&&(e.school._id==a.value._id||e.town._id===s.value._id&&a.value._id==="all")),v(m.value)}function j(){return U.filter(e=>e.town._id===s.value._id)}return(e,u)=>(c(),f(N,null,{default:o(()=>[d(A,null,{default:o(()=>[x("Поиск клубов")]),_:1}),d(b,{class:"ma-0 pa-0 mt-4",style:{gap:"12px"}},{default:o(()=>[d(p,{cols:"12",md:"4",sm:"8",xs:"12",class:"ml-0 pa-0"},{default:o(()=>[d(V,{label:"Город",modelValue:r(s),"onUpdate:modelValue":u[0]||(u[0]=l=>S(s)?s.value=l:s=l),items:r(g),"item-title":"name","return-object":"",variant:"solo","hide-details":""},null,8,["modelValue","items"])]),_:1}),d(p,{cols:"12",md:"4",sm:"8",xs:"12",class:"ma-0 pa-0"},{default:o(()=>[d(V,{label:"Школа",modelValue:r(a),"onUpdate:modelValue":[u[1]||(u[1]=l=>S(a)?a.value=l:a=l),k],items:[{name:"Все",_id:"all"},...j()],"item-title":"name","return-object":"",variant:"solo","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),d(b,{class:"w-100 mt-5 flex-row flex-wrap"},{default:o(()=>[(c(!0),F(q,null,M(r(m),l=>(c(),f(p,{cols:"12",sm:"6",xs:"12",key:l._id},{default:o(()=>[(c(),f(R,null,{default:o(()=>[d(E,{entry:l,show_location:r(a)._id==="all"},null,8,["entry","show_location"])]),_:2},1024))]),_:2},1024))),128))]),_:1}),r(m).length===0?(c(),f(p,{key:0,cols:"12",sm:"6",xs:"12",class:"text-h6 ma-auto font-weight-medium mt-4 text-center"},{default:o(()=>[x("Клубов нет, или вы на всё откликнулись")]),_:1})):y("",!0)]),_:1}))}});export{Q as default};
