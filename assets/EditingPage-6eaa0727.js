import{d as N,a as T,u as F,w as M,r as p,c as R,b as o,g as A,o as D,f as s,H as E,j as e,i as y,a2 as w,X as $,Y as H,Z as h,a0 as L,a3 as O,T as P,U as X,L as Y,k as Z,D as q,B as z}from"./index-a7c02cab.js";import{_ as G}from"./BackButton.vue_vue_type_script_setup_true_lang-b11ea951.js";import{u as I,a as c}from"./vee-validate.esm-ef4f8042.js";import{u as J}from"./entry-0acbcb40.js";import"./EntryService-ef81a948.js";const K=z("div",{class:"text-h5 text-center font-weight-bold"},"Редактирование",-1),se=N({__name:"EditingPage",props:["id"],async setup(_){let m,b;const g=_;let x=T().getUser(),j=F(),V=J(),i=([m,b]=M(()=>V.get_by_id(g.id)),m=await m,b(),m),C=[{name:"Запись",type:"mentor"},{name:"Урок",type:"lesson"},{name:"Клуб",type:"club"}],u=p(i.type),r=p(!!i.limit),f=p(!1);const{meta:S,handleSubmit:U,handleReset:Q,validate:k}=I({validationSchema:{subject(t){return!t||t.length<4?"слишком короткий заголовок":t.length>25?"слишком длинный заголовок":!0},description(t){return!t||t.length<20?"слишком короткое описание":t.length>150?"слишком длинное описание":!0},limit(t){return r.value?!t||t.length===0?"заполните поле или уберите лимит":!/^\d+$/.test(t)||!(Number(t)>0)?"неверное значение":Number(t)>300?"многовато":!0:!0}}});let d=c("subject"),v=c("description"),n=c("limit");d.value.value=i.subject,v.value.value=i.description,n.value.value=i.limit;const B=U(async t=>{f.value=!0;let a=Object.assign(t,{type:u.value});r.value&&(a.limit=n.value.value),await V.edit(g.id,a).then(()=>j.push(`/user/${x._id}`)).finally(()=>f.value=!1)});return(t,a)=>(D(),R(A,null,{default:o(()=>[s(G),s(q,{cols:"12",sm:"8",lg:"5",class:"ma-auto"},{default:o(()=>[K,s(E,{label:"Что?",items:e(C),modelValue:e(u),"onUpdate:modelValue":a[0]||(a[0]=l=>y(u)?u.value=l:u=l),"item-title":"name","item-value":"type",variant:"solo",class:"mt-4"},null,8,["items","modelValue"]),s(w,{name:"bounce"},{default:o(()=>[s($,{onSubmit:H(e(B),["prevent"]),class:"d-flex flex-column align-center justify-center w-100"},{default:o(()=>[s(h,{label:"Заголовок",placeholder:e(u)==="club"?"Клуб любителей Мафии":"Биология",modelValue:e(d).value.value,"onUpdate:modelValue":a[1]||(a[1]=l=>e(d).value.value=l),"error-messages":e(d).errorMessage.value,variant:"solo",class:"w-100"},null,8,["placeholder","modelValue","error-messages"]),s(L,{label:"Описание",modelValue:e(v).value.value,"onUpdate:modelValue":a[2]||(a[2]=l=>e(v).value.value=l),"error-messages":e(v).errorMessage.value,counter:150,variant:"solo",class:"w-100"},null,8,["modelValue","error-messages"]),s(O,{label:"Лимит учеников",modelValue:e(r),"onUpdate:modelValue":a[3]||(a[3]=l=>y(r)?r.value=l:r=l),onClick:a[4]||(a[4]=l=>e(k)()),class:"w-100","hide-details":""},null,8,["modelValue"]),s(w,{name:"bounce"},{default:o(()=>[P(s(h,{type:"number",variant:"solo",label:"Сколько?",modelValue:e(n).value.value,"onUpdate:modelValue":a[5]||(a[5]=l=>e(n).value.value=l),"error-messages":e(n).errorMessage.value,class:"w-100 mb-3"},null,8,["modelValue","error-messages"]),[[X,e(r)]])]),_:1}),s(Y,{color:"accent",disabled:!e(S).valid,type:"submit",loading:e(f)},{default:o(()=>[Z("Отправить")]),_:1},8,["disabled","loading"])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1}))}});export{se as default};
