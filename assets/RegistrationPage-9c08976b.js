import{d as O,u as D,a as G,w as h,r as x,c as H,b as o,g as L,e as P,o as X,f as r,E as Z,X as q,j as l,Z as V,ab as y,H as z,_ as I,i as J,$ as C,a3 as K,B as c,k as w,L as M,D as Q}from"./index-a7c02cab.js";import{_ as W}from"./BackButton.vue_vue_type_script_setup_true_lang-b11ea951.js";import{u as Y,a as u}from"./vee-validate.esm-ef4f8042.js";import{u as ee}from"./school-bdd1772f.js";import{u as le}from"./town-8d6ffef6.js";const ae=c("div",{class:"text-h6 font-weight-bold"}," Регистрация ",-1),te={class:"text-start"},ve=O({__name:"RegistrationPage",async setup(re){let s,i;document.title="Регистрация — Ищу наставника";let S=D(),U=G(),k=ee(),R=le(),j=([s,i]=h(()=>R.get_all()),s=await s,i(),s),B=([s,i]=h(()=>k.get_all()),s=await s,i(),s);function F(){return B.filter(e=>{var a;return e.town._id===((a=n.value.value)==null?void 0:a._id)})}function A(){let e=[{digit:"—",number:0}];for(let a=1;a<=11;a++)e.push({digit:a.toString(),number:a});return e}const{meta:N,handleSubmit:T,handleReset:se,validate:oe}=Y({validationSchema:{name(e){return!e||e.length===0?"введите фамилию, имя":e.length<4?"слишком короткое имя и фамилия":e.length>22?"слишком длинное имя и фамилия":!0},email(e){return!e||e.length===0?"введите почту":/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(e)?!0:"неправильно ведено"},password(e){return!e||e.length===0?"введите пароль":e.length<8?"минимум 8 символов":e.length>30?"слишком длинный пароль":!0},town(e){return e?!0:"укажите свой город"},school(e){return e?!0:"укажите свою школу"},grade(e){return!0},agree(e){return e?!0:"нужно ваше соглашение"}}});let d=u("name"),v=u("email"),g=u("password"),n=u("town"),f=u("school"),p=u("grade"),b=u("agree"),m=x(!1),_=x(!1);const $=T(async e=>{_.value=!0,await U.registration(Object.assign(e,{roles:["student",m.value?"mentor":null]})).finally(()=>_.value=!1)});return(e,a)=>{const E=P("router-link");return X(),H(L,null,{default:o(()=>[r(W),r(Q,{cols:"12",xs:"12",sm:"10",md:"7",lg:"5",class:"mt-4 ma-auto"},{default:o(()=>[r(Z,{class:"d-flex flex-column justify-center align-center text-center w-100 pl-6 pr-6 pt-4 pb-6 rounded-lg"},{default:o(()=>[ae,r(q,{class:"mt-4 w-100",onSubmit:l($)},{default:o(()=>[r(V,{label:"Имя Фамилия",type:"name",placeholder:"Иван Иванов",modelValue:l(d).value.value,"onUpdate:modelValue":a[0]||(a[0]=t=>l(d).value.value=t),"error-messages":l(d).errors.value,variant:"underlined",class:"w-100 mb-1"},null,8,["modelValue","error-messages"]),r(V,{label:"Email",type:"email",placeholder:"vasya@ya.ru",modelValue:l(v).value.value,"onUpdate:modelValue":a[1]||(a[1]=t=>l(v).value.value=t),"error-messages":l(v).errors.value,variant:"underlined",class:"w-100 mb-1 mt-2"},null,8,["modelValue","error-messages"]),r(V,{label:"Пароль",type:"password",modelValue:l(g).value.value,"onUpdate:modelValue":a[2]||(a[2]=t=>l(g).value.value=t),"error-messages":l(g).errors.value,variant:"underlined",class:"w-100 mb-1 mt-2"},null,8,["modelValue","error-messages"]),r(y,{label:"Город",modelValue:l(n).value.value,"onUpdate:modelValue":a[3]||(a[3]=t=>l(n).value.value=t),"error-messages":l(n).errors.value,items:l(j),"return-object":"","item-title":"name",variant:"underlined",class:"w-100 mb-1 mt-8"},null,8,["modelValue","error-messages","items"]),r(y,{label:"Школа",modelValue:l(f).value.value,"onUpdate:modelValue":a[4]||(a[4]=t=>l(f).value.value=t),disabled:!l(n).value.value,"error-messages":l(f).errors.value,items:F(),"item-title":"name","return-object":"",variant:"underlined",class:"w-100 mb-1 mt-8"},null,8,["modelValue","disabled","error-messages","items"]),r(z,{label:"Класс",modelValue:l(p).value.value,"onUpdate:modelValue":a[5]||(a[5]=t=>l(p).value.value=t),"error-messages":l(p).errors.value,items:A(),"item-title":"digit","item-value":"number",variant:"underlined",class:"w-100 mb-1 mt-6"},null,8,["modelValue","error-messages","items"]),r(I,{modelValue:l(m),"onUpdate:modelValue":a[6]||(a[6]=t=>J(m)?m.value=t:m=t),label:"Кто вы?","hide-details":"",class:"mt-8",column:""},{default:o(()=>[r(C,{label:"Наставляемый",value:!1}),r(C,{label:"Наставник",value:!0})]),_:1},8,["modelValue"]),r(K,{modelValue:l(b).value.value,"onUpdate:modelValue":a[7]||(a[7]=t=>l(b).value.value=t),"error-messages":l(b).errors.value,class:"w-100 mt-4 ma-0 pa-0 align-start"},{label:o(()=>[c("div",te,[w(" Принимаю "),r(E,{to:"/termsOfUse"},{default:o(()=>[w("пользовательское соглашение")]),_:1})])]),_:1},8,["modelValue","error-messages"]),r(M,{type:"submit",disabled:!l(N).valid,color:"accent",class:"mt-6"},{default:o(()=>[w(" Отправить ")]),_:1},8,["disabled"])]),_:1},8,["onSubmit"]),c("div",{onClick:a[8]||(a[8]=t=>l(S).push("/login")),class:"text-subtitle-1 w-100 cursor-pointer font-weight-semibold pa-1 mt-2"}," вход ")]),_:1})]),_:1})]),_:1})}}});export{ve as default};
