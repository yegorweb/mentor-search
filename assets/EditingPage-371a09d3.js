import{d as U,a as B,u as F,w as T,r as p,c as R,e as o,g as $,o as A,f as s,a4 as D,l as e,k as y,a5 as h,Z as E,_ as O,$ as w,a2 as P,a6 as Z,a7 as q,a8 as z,M as G,j as H,D as I,h as J}from"./index-4f6c5d65.js";import{_ as K}from"./BackButton.vue_vue_type_script_setup_true_lang-603e5d2f.js";import{u as L,a as c}from"./vee-validate.esm-0f4ff9e4.js";import{u as Q}from"./entry-7a05a159.js";import"./EntryService-e6d5ed51.js";const W=J("div",{class:"text-h5 text-center font-weight-bold"},"Редактирование",-1),se=U({__name:"EditingPage",props:["id"],async setup(_){let m,b;const V=_;let x=B().user,j=F(),g=Q(),i=([m,b]=T(()=>g.get_by_id(V.id)),m=await m,b(),m),C=[{name:"Запись",type:"mentor"},{name:"Урок",type:"lesson"},{name:"Клуб",type:"club"}],u=p(i.type),r=p(!!i.limit),f=p(!1);const{meta:S,handleSubmit:k,handleReset:X,validate:M}=L({validationSchema:{subject(a){return!a||a.length<4?"слишком короткий заголовок":a.length>25?"слишком длинный заголовок":!0},description(a){return!a||a.length<20?"слишком короткое описание":a.length>150?"слишком длинное описание":!0},limit(a){return r.value?!a||a.length===0?"заполните поле или уберите лимит":!/^\d+$/.test(a)||!(Number(a)>0)?"неверное значение":Number(a)>300?"многовато":!0:!0}}});let d=c("subject"),v=c("description"),n=c("limit");d.value.value=i.subject,v.value.value=i.description,n.value.value=i.limit;const N=k(async a=>{f.value=!0;let l=Object.assign(a,{type:u.value});r.value&&(l.limit=n.value.value),await g.edit(V.id,l).then(()=>j.push(`/user/${x._id}`)).finally(()=>f.value=!1)});return(a,l)=>(A(),R($,null,{default:o(()=>[s(K),s(I,{cols:"12",sm:"8",lg:"5",class:"ma-auto"},{default:o(()=>[W,s(D,{label:"Что?",items:e(C),modelValue:e(u),"onUpdate:modelValue":l[0]||(l[0]=t=>y(u)?u.value=t:u=t),"item-title":"name","item-value":"type",variant:"solo",class:"mt-4"},null,8,["items","modelValue"]),s(h,{name:"bounce"},{default:o(()=>[s(E,{onSubmit:O(e(N),["prevent"]),class:"d-flex flex-column align-center justify-center w-100"},{default:o(()=>[s(w,{label:"Заголовок",placeholder:e(u)==="club"?"Клуб любителей Мафии":"Биология",modelValue:e(d).value.value,"onUpdate:modelValue":l[1]||(l[1]=t=>e(d).value.value=t),"error-messages":e(d).errorMessage.value,variant:"solo",class:"w-100"},null,8,["placeholder","modelValue","error-messages"]),s(P,{label:"Описание",modelValue:e(v).value.value,"onUpdate:modelValue":l[2]||(l[2]=t=>e(v).value.value=t),"error-messages":e(v).errorMessage.value,counter:150,variant:"solo",class:"w-100"},null,8,["modelValue","error-messages"]),s(Z,{label:"Лимит учеников",modelValue:e(r),"onUpdate:modelValue":l[3]||(l[3]=t=>y(r)?r.value=t:r=t),onClick:l[4]||(l[4]=t=>e(M)()),class:"w-100","hide-details":""},null,8,["modelValue"]),s(h,{name:"bounce"},{default:o(()=>[q(s(w,{type:"number",variant:"solo",label:"Сколько?",modelValue:e(n).value.value,"onUpdate:modelValue":l[5]||(l[5]=t=>e(n).value.value=t),"error-messages":e(n).errorMessage.value,class:"w-100 mb-3"},null,8,["modelValue","error-messages"]),[[z,e(r)]])]),_:1}),s(G,{color:"accent",disabled:!e(S).valid,type:"submit",loading:e(f)},{default:o(()=>[H("Отправить")]),_:1},8,["disabled","loading"])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1}))}});export{se as default};
