import{d as U,a as j,u as k,r as c,c as v,b as u,g as N,o as b,f as s,H as B,j as e,i as V,a2 as g,X as T,Y as F,Z as h,a0 as M,a3 as R,T as D,U as E,L as $,k as A,v as H,D as L,B as O}from"./index-a7c02cab.js";import{_ as P}from"./BackButton.vue_vue_type_script_setup_true_lang-b11ea951.js";import{E as X}from"./EntryService-ef81a948.js";import{u as Y,a as p}from"./vee-validate.esm-ef4f8042.js";const Z=O("div",{class:"text-h5 text-center font-weight-bold"},"Создать",-1),Q=U({__name:"CreatingPage",setup(q){let n=j().getUser(),w=k(),y=[{name:"Запись",type:"mentor"},{name:"Урок",type:"lesson"},{name:"Клуб",type:"club"}],r=c(null),o=c(!1),i=c(!1);const{meta:x,handleSubmit:_,handleReset:z,validate:C}=Y({validationSchema:{subject(a){return!a||a.length<4?"слишком короткий заголовок":a.length>25?"слишком длинный заголовок":!0},description(a){return!a||a.length<20?"слишком короткое описание":a.length>150?"слишком длинное описание":!0},limit(a){return o.value?!a||a.length===0?"заполните поле или уберите лимит":!/^\d+$/.test(a)||!(Number(a)>0)?"неверное значение":Number(a)>300?"многовато":!0:!0}}});let m=p("subject"),d=p("description"),f=p("limit");const S=_(async a=>{i.value=!0,await X.create(Object.assign(a,{type:r.value,school:n.school._id,town:n.town._id})).then(()=>w.push(`/user/${n._id}`)).finally(()=>i.value=!1)});return(a,l)=>(b(),v(N,null,{default:u(()=>[s(P),s(L,{cols:"12",sm:"8",lg:"5",class:"ma-auto"},{default:u(()=>[Z,s(B,{label:"Что?",items:e(y),modelValue:e(r),"onUpdate:modelValue":l[0]||(l[0]=t=>V(r)?r.value=t:r=t),"item-title":"name","item-value":"type",variant:"solo",class:"mt-4"},null,8,["items","modelValue"]),s(g,{name:"bounce"},{default:u(()=>[e(r)?(b(),v(T,{key:0,onSubmit:F(e(S),["prevent"]),class:"d-flex flex-column align-center justify-center w-100"},{default:u(()=>[s(h,{label:"Заголовок",placeholder:e(r)==="club"?"Клуб любителей Мафии":"Биология",modelValue:e(m).value.value,"onUpdate:modelValue":l[1]||(l[1]=t=>e(m).value.value=t),"error-messages":e(m).errorMessage.value,variant:"solo",class:"w-100"},null,8,["placeholder","modelValue","error-messages"]),s(M,{label:"Описание",modelValue:e(d).value.value,"onUpdate:modelValue":l[2]||(l[2]=t=>e(d).value.value=t),"error-messages":e(d).errorMessage.value,counter:150,variant:"solo",class:"w-100"},null,8,["modelValue","error-messages"]),s(R,{label:"Лимит учеников",modelValue:e(o),"onUpdate:modelValue":l[3]||(l[3]=t=>V(o)?o.value=t:o=t),onClick:l[4]||(l[4]=t=>e(C)()),class:"w-100","hide-details":""},null,8,["modelValue"]),s(g,{name:"bounce"},{default:u(()=>[D(s(h,{type:"number",variant:"solo",label:"Сколько?",modelValue:e(f).value.value,"onUpdate:modelValue":l[5]||(l[5]=t=>e(f).value.value=t),"error-messages":e(f).errorMessage.value,class:"w-100 mb-3"},null,8,["modelValue","error-messages"]),[[E,e(o)]])]),_:1}),s($,{color:"accent",disabled:!e(x).valid,type:"submit",loading:e(i)},{default:u(()=>[A("Отправить")]),_:1},8,["disabled","loading"])]),_:1},8,["onSubmit"])):H("",!0)]),_:1})]),_:1})]),_:1}))}});export{Q as default};
