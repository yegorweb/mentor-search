import{_ as le}from"./BackButton.vue_vue_type_script_setup_true_lang-a6a8d385.js";import{_ as v}from"./MentorEntry.vue_vue_type_script_setup_true_lang-f594a3a2.js";import{E as W}from"./EntryService-e0219c97.js";import{d as se,u as ae,a as oe,r as c,w as $,H as ne,c as u,b as o,g as re,U as D,o as t,B as d,f as r,j as e,p as n,h as X,v as i,l as ie,t as y,k as F,F as m,q as x,I as Y,C as _,D as b,J as ue,K as de,_ as ce}from"./index-7dc65faa.js";const U=V=>(ue("data-v-f010483e"),V=V(),de(),V),_e={class:"d-flex flex-row w-100 flex-nowrap justify-space-between align-center"},fe=U(()=>d("div",{class:"text-body-4 ml-1 font-weight-semibold"},"выйти",-1)),me={style:{"column-gap":"30px","row-gap":"10px"},class:"box w-100 mt-4 d-flex flex-column flex-sm-row flex-nowrap justify-center justify-sm-start align-center align-sm-start"},he={class:"d-flex flex-column justify-center justify-sm-start w-sm-100 align-center align-sm-start"},pe={class:"text-h5 text-center font-weight-bold"},ge={style:{"column-gap":"20px"},class:"d-flex mt-1 align-center justify-center justify-sm-start flex-wrap flex-row font-weight-bold text-text_gray"},xe={key:0},we={key:1},ve={class:"font-weight-bold text-text_gray"},ye={key:0,class:"mt-2 pb-2 text-center text-sm-start"},be={key:1,class:"d-flex pt-2 flex-row flex-wrap"},ke=["href"],je=U(()=>d("div",{class:"text-h5 font-weight-bold"},"На модерации",-1)),Ue=U(()=>d("div",{class:"text-h5 mb-4 mt-8 font-weight-bold"},"Мои отклики",-1)),Ve={key:0,class:"text-h5 mb-4 font-weight-bold"},Ce={key:0,class:"text-h5 mb-4 font-weight-bold"},Be=U(()=>d("div",{class:"text-h5 font-weight-bold"},"Наставник по",-1)),Ae=U(()=>d("div",{class:"text-h5 font-weight-bold"},"Уроки",-1)),Ie=U(()=>d("div",{class:"text-h5 font-weight-bold"},"Клубы",-1)),Se=se({__name:"AccountPage",props:["id"],async setup(V){var J,K,L,G,M;let f,k;const T=V;ae();let g=oe(),h=g.getUser(),w=T.id,j=c(((J=g.getUser())==null?void 0:J._id)===w),Z=((K=h==null?void 0:h.roles)==null?void 0:K.includes("school-admin"))&&((L=h==null?void 0:h.administered_schools)==null?void 0:L.includes(s.value.school._id))||((G=h==null?void 0:h.roles)==null?void 0:G.includes("global-admin")),s=c(((M=g.getUser())==null?void 0:M._id)===w?g.getUser():([f,k]=$(()=>D.get_by_id(w)),f=await f,k(),f).data),q=c(s.value.town),H=c(s.value.school),p=c(([f,k]=$(()=>W.get_by_author(s.value._id)),f=await f,k(),f).data),N=c(p.value.filter(l=>l.type==="mentor"&&l.on_moderation===!1&&l.moderation_result===!0)),z=c(p.value.filter(l=>l.type==="lesson"&&l.on_moderation===!1&&l.moderation_result===!0)),E=c(p.value.filter(l=>l.type==="club"&&l.on_moderation===!1&&l.moderation_result===!0)),C=c(p.value.filter(l=>l.on_moderation===!0||j.value&&l.on_moderation===!1&&l.moderation_result===!1));function ee(){var l,R,I;return(l=s.value.roles)!=null&&l.includes("school-admin")||(R=s.value.roles)!=null&&R.includes("global-admin")?"админ":(I=s.value.roles)!=null&&I.includes("mentor")?"наставник":"наставляемый"}document.title=`${s.value.name} — Ищу наставника`,ne(async()=>{w=T.id,s.value=g.getUser()._id===w?g.getUser():(await D.get_by_id(w)).data,q.value=s.value.town,H.value=s.value.school,p.value=(await W.get_by_author(s.value._id)).data,N.value=p.value.filter(l=>l.type==="mentor"),z.value=p.value.filter(l=>l.type==="lesson"),E.value=p.value.filter(l=>l.type==="club"),j.value=g.getUser()._id===w});async function te(){await g.logout(),window.location.href="/"}let B=c([]),A=c([]),S=c([]),P=c([]);return s.value.roles.includes("mentor")||(B.value=([f,k]=$(()=>D.get_my_responses()),f=await f,k(),f).data,A.value=B.value.filter(l=>l.type==="mentor"),S.value=B.value.filter(l=>l.type==="lesson"),P.value=B.value.filter(l=>l.type==="club")),(l,R)=>(t(),u(re,{class:"mt-1"},{default:o(()=>{var I,O,Q;return[d("div",_e,[r(le),e(j)?(t(),n("div",{key:0,onClick:te,class:"d-flex pt-1 pr-1 pb-1 cursor-pointer flex-row flex-nowrap align-center justify-start"},[r(X,{icon:"mdi-logout"}),fe])):i("",!0)]),d("div",me,[r(ie,{image:(I=e(s))==null?void 0:I.avatar_url,color:"blue",size:"130"},null,8,["image"]),d("div",he,[d("div",pe,y((O=e(s))==null?void 0:O.name),1),d("div",ge,[d("div",null,y(ee()),1),e(s).ranks&&e(s).ranks.length!=0?(t(),n("div",xe,[d("span",null,[r(X,{icon:"mdi-star"})]),F(" "+y(e(s).ranks.join(", ")),1)])):i("",!0),e(s).grade!=0?(t(),n("div",we,y(e(s).grade)+" класс",1)):i("",!0)]),d("div",ve,y(e(q).name+", "+e(H).name),1),e(s).description&&e(s).description.length>0?(t(),n("div",ye,y(e(s).description),1)):i("",!0),e(s).contacts&&e(s).contacts.length>0?(t(),n("div",be,[(t(!0),n(m,null,x((Q=e(s))==null?void 0:Q.contacts,a=>(t(),n("a",{key:a.link,about:"_blank",href:a.link,style:{"text-decoration":"none"}},[r(Y,{size:"small",variant:"tonal",class:"text-body-2 pl-5 pr-5 mr-3 font-weight-semibold bg-button"},{default:o(()=>[F(y(a.name),1)]),_:2},1024)],8,ke))),128))])):i("",!0),e(j)?(t(),u(Y,{key:2,size:"small",variant:"tonal",to:"/settings",class:"text-body-2 mt-2 pl-5 pr-5 font-weight-semibold bg-blue"},{default:o(()=>[F(" Редактировать профиль ")]),_:1})):i("",!0)])]),(e(j)||e(Z))&&e(C)&&e(C).length>0?(t(),n(m,{key:0},[e(C)&&e(C).length>0?(t(),u(_,{key:0,class:"flex-column mt-8 ma-0 pa-0 w-100"},{default:o(()=>[je,r(_,{class:"w-100 mt-4 flex-row flex-wrap"},{default:o(()=>[(t(!0),n(m,null,x(e(C),a=>(t(),u(b,{key:a._id,cols:"12",sm:"6",xs:"12"},{default:o(()=>[r(v,{hide_user:"",entry:a,show_location:!1},null,8,["entry"])]),_:2},1024))),128))]),_:1})]),_:1})):i("",!0)],64)):i("",!0),e(j)&&!e(s).roles.includes("mentor")&&e(B).length>0?(t(),n(m,{key:1},[Ue,e(A).length!==0?(t(),u(_,{key:0,class:"pt-2 pb-4"},{default:o(()=>[(t(!0),n(m,null,x(e(A),a=>(t(),u(b,{key:a==null?void 0:a._id,cols:"12",sm:"6",xs:"12"},{default:o(()=>[r(v,{hide_user:"",entry:a,show_location:!1},null,8,["entry"])]),_:2},1024))),128))]),_:1})):i("",!0),e(S).length!==0?(t(),u(_,{key:1,class:"flex-column pt-4 pb-4 ma-0 pa-0"},{default:o(()=>[e(A).length!==0?(t(),n("div",Ve,"Уроки")):i("",!0),r(_,{class:"w-100 flex-row flex-wrap"},{default:o(()=>[(t(!0),n(m,null,x(e(S),a=>(t(),u(b,{key:a._id,cols:"12",sm:"6",xs:"12"},{default:o(()=>[r(v,{hide_user:"",entry:a,show_location:!1},null,8,["entry"])]),_:2},1024))),128))]),_:1})]),_:1})):i("",!0),e(P).length!==0?(t(),u(_,{key:2,class:"flex-column pt-4 ma-0 pa-0"},{default:o(()=>[e(A).length!==0||e(S).length!==0?(t(),n("div",Ce,"Клубы")):i("",!0),r(_,{class:"w-100 flex-row flex-wrap"},{default:o(()=>[(t(!0),n(m,null,x(e(P),a=>(t(),u(b,{key:a._id,cols:"12",sm:"6",xs:"12"},{default:o(()=>[r(v,{hide_user:"",entry:a,show_location:!1},null,8,["entry"])]),_:2},1024))),128))]),_:1})]),_:1})):i("",!0)],64)):i("",!0),e(s).roles.includes("mentor")||e(p).length>0?(t(),n(m,{key:2},[e(N).length!==0?(t(),u(_,{key:0,class:"flex-column mt-8 ma-0 pa-0 w-100"},{default:o(()=>[Be,r(_,{class:"w-100 mt-4 flex-row flex-wrap"},{default:o(()=>[(t(!0),n(m,null,x(e(N),a=>(t(),u(b,{key:a._id,cols:"12",sm:"6",xs:"12"},{default:o(()=>[r(v,{hide_user:"",entry:a,show_location:!1},null,8,["entry"])]),_:2},1024))),128))]),_:1})]),_:1})):i("",!0),e(z).length!==0?(t(),u(_,{key:1,class:"flex-column mt-8 ma-0 pa-0"},{default:o(()=>[Ae,r(_,{class:"w-100 mt-4 flex-row flex-wrap"},{default:o(()=>[(t(!0),n(m,null,x(e(z),a=>(t(),u(b,{key:a._id,cols:"12",sm:"6",xs:"12"},{default:o(()=>[r(v,{hide_user:"",entry:a,show_location:!1},null,8,["entry"])]),_:2},1024))),128))]),_:1})]),_:1})):i("",!0),e(E).length!==0?(t(),u(_,{key:2,class:"flex-column mt-8 ma-0 pa-0"},{default:o(()=>[Ie,r(_,{class:"w-100 mt-4 flex-row flex-wrap"},{default:o(()=>[(t(!0),n(m,null,x(e(E),a=>(t(),u(b,{key:a._id,cols:"12",sm:"6",xs:"12"},{default:o(()=>[r(v,{hide_user:"",entry:a,show_location:!1},null,8,["entry"])]),_:2},1024))),128))]),_:1})]),_:1})):i("",!0)],64)):i("",!0)]}),_:1}))}});const Re=ce(Se,[["__scopeId","data-v-f010483e"]]);export{Re as default};
