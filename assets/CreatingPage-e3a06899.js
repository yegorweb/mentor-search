import{d as S,a as k,u as N,r as f,c as v,e as u,g as M,o as V,f as s,a4 as U,l as e,k as b,a5 as g,Z as B,_ as F,$ as h,a2 as T,a6 as $,a7 as D,a8 as E,M as R,j as A,v as O,D as P,h as Z}from"./index-2a8a9a72.js";import{_ as q}from"./BackButton.vue_vue_type_script_setup_true_lang-c7282861.js";import{E as z}from"./EntryService-b35f003c.js";import{u as G,a as p}from"./vee-validate.esm-1e1674fa.js";const H=Z("div",{class:"text-h5 text-center font-weight-bold"}," Создать ",-1),W=S({__name:"CreatingPage",setup(I){let n=k().user,w=N(),_=[{name:"Запись",type:"mentor"},{name:"Урок",type:"lesson"},{name:"Клуб",type:"club"}],r=f(null),o=f(!1),i=f(!1);const{meta:x,handleSubmit:y,validate:C}=G({initialValues:{subject:"",description:"",limit:null},validationSchema:{subject(a){return a.trim().length<4?"слишком короткий заголовок":a.length>32?"слишком длинный заголовок":!0},description(a){return a.trim().length<20?"слишком короткое описание":a.length>150?"слишком длинное описание":!0},limit(a){return o.value?!a||a.length===0?"заполните поле или уберите лимит":!/^\d+$/.test(a)||!(Number(a)>0)?"неверное значение":Number(a)>300?"многовато":!0:!0}}});let m=p("subject"),d=p("description"),c=p("limit");const j=y(async a=>{i.value=!0,await z.create(Object.assign(a,{type:r.value,school:n.school._id,town:n.town._id})),w.push(`/user/${n._id}`),i.value=!1});return(a,l)=>(V(),v(M,null,{default:u(()=>[s(q),s(P,{cols:"12",sm:"8",lg:"5",class:"ma-auto"},{default:u(()=>[H,s(U,{label:"Что?",items:e(_),modelValue:e(r),"onUpdate:modelValue":l[0]||(l[0]=t=>b(r)?r.value=t:r=t),"item-title":"name","item-value":"type",variant:"solo",class:"mt-4"},null,8,["items","modelValue"]),s(g,{name:"bounce"},{default:u(()=>[e(r)?(V(),v(B,{key:0,onSubmit:F(e(j),["prevent"]),class:"d-flex flex-column align-center justify-center w-100"},{default:u(()=>[s(h,{label:"Заголовок",placeholder:e(r)==="club"?"Клуб любителей Мафии":"Биология",modelValue:e(m).value.value,"onUpdate:modelValue":l[1]||(l[1]=t=>e(m).value.value=t),"error-messages":e(m).errorMessage.value,variant:"solo",class:"w-100"},null,8,["placeholder","modelValue","error-messages"]),s(T,{label:"Описание",modelValue:e(d).value.value,"onUpdate:modelValue":l[2]||(l[2]=t=>e(d).value.value=t),"error-messages":e(d).errorMessage.value,counter:150,variant:"solo",class:"w-100"},null,8,["modelValue","error-messages"]),s($,{label:"Лимит учеников",modelValue:e(o),"onUpdate:modelValue":l[3]||(l[3]=t=>b(o)?o.value=t:o=t),onClick:l[4]||(l[4]=t=>e(C)()),class:"w-100","hide-details":""},null,8,["modelValue"]),s(g,{name:"bounce"},{default:u(()=>[D(s(h,{type:"number",variant:"solo",label:"Сколько?",modelValue:e(c).value.value,"onUpdate:modelValue":l[5]||(l[5]=t=>e(c).value.value=t),"error-messages":e(c).errorMessage.value,class:"w-100 mb-3"},null,8,["modelValue","error-messages"]),[[E,e(o)]])]),_:1}),s(R,{color:"accent",disabled:!e(x).valid,type:"submit",loading:e(i)},{default:u(()=>[A(" Отправить ")]),_:1},8,["disabled","loading"])]),_:1},8,["onSubmit"])):O("",!0)]),_:1})]),_:1})]),_:1}))}});export{W as default};
